# ----------------------------------------------------
# ----------------- Artifact with CoTN immunity --------------
# ----------------------------------------------------
#
# Create ability protection from CoTN and bind to Artifact ID
#
# ----------------------------------------------------
--- # ----------- ORIGINAL EXE 3.1 PATCH DATA ------------
group: Original
checkAddress:   00000400
checkBytes:     8D 41 34 C3 CC CC CC CC
patchAddress:   00576486  ## 00977086                           ## Jump to new code space
originalBytes:  83 7C 24 10 00 0F 8E 9E 00 00 00
patchBytes:     E9 95 F7 7B 00 90 90 90 90 90 90
---
group: Original
patchAddress:   00BD9A00                                        ## Add ASCI description of the patch in asselby
originalBytes:  00*                                              
patchBytes:     3d 3d 3d 3d 3d 3d 3d 3d 3d 3d 3d 3d 3d 3d 3d 3d 43 4f 54 4e 20 69 6d 75 6e 65 20 61 62 6c 74 79
---
group: Original
patchAddress:   00BD9A20  ## 01136820                           ## added code
originalBytes:  00*                                         
patchBytes:     83 FE 15 74 13 68 B4 00 00 00 89 C1 E8 81 A2 74 FF 85 C0 E9 D9 23 77 FF 83 FE 23 74 10 6A 46 89 C1 E8 6E A2 74 FF 85 C0 E9 C4 23 77 FF B8 01 00 00 00 85 C0 E9 B8 23 77 FF
--- # --------------- QUANTOMAS 3.1j PATCH DATA ---------------
group: Quantomas3.1j
checkAddress:   00000400
checkBytes:     56 57 8B 7C 24 0C 57 8B F1 E8 D2 B7 00 00 83 C4   
patchAddress:   004B7FA8  ## 008B8BA8                           ## change switch scope from 11-20 to 11-21
originalBytes:  83 F8 09                                              
patchBytes:     83 F8 10
---
group: Quantomas3.1j
patchAddress:   004B7FB1  ## 008B8BB1                           ## Add ASCI description of the patch in asselby
originalBytes:  FF 24 85 18 92 8B 00                                          
patchBytes:     FF 24 85 20 6A 14 01
---
group: Quantomas3.1j
patchAddress:   004B8618  ## 008B9218                           ## Zero the old switch to make space for other things
originalBytes:  D0 8B 8B 00 8B 8C 8B 00 1C 8E 8B 00 56 8D 8B 00 1C 8E 8B 00 1C 8E 8B 00 BF 8B 8B 00 63 8C 8B 00 B8 8B 8B 00 DA 8B 8B 00
patchBytes:     90*
---
group: Quantomas3.1j
patchAddress:   00BD9A20  ## 01146A20                           ## Add new switch + case 21 pointer
originalBytes:  00*                                         
patchBytes:     D0 8B 8B 00 8B 8C 8B 00 1C 8E 8B 00 56 8D 8B 00 1C 8E 8B 00 1C 8E 8B 00 BF 8B 8B 00 63 8C 8B 00 B8 8B 8B 00 DA 8B 8B 00 70 6A 14 01
---
group: Quantomas3.1j
patchAddress:   00BD9A70  ## 01146A70                           ## case 21 CoTN specifics
originalBytes:  00*                                         
patchBytes:     68 B4 00 00 00 E8 35 A2 74 FF 85 C0 0F 84 BB 24 77 FF E9 AD 24 77 FF 90
#---
#################################
#group: Quantomas3.1j
#patchAddress:   00BD9A00  ## 01146A00                           ## Add ASCI description of the patch in asselby
#originalBytes:  00*                                              
#patchBytes:     3d 3d 3d 3d 3d 3d 3d 3d 3d 3d 3d 3d 3d 3d 3d 3d 43 4f 54 4e 20 69 6d 75 6e 65 20 61 62 6c 74 79
#---
#group: Quantomas3.1j
#patchAddress:   00BD9A20  ## 01146A20                           ## added code
#originalBytes:  00*                                             
#patchBytes:     83 FE 15 74 13 68 B4 00 00 00 89 C1 E8 81 A2 74 FF 85 C0 E9 D9 23 77 FF 83 FE 23 74 10 6A 46 89 C1 E8 6E A2 74 FF 85 C0 E9 C4 23 77 FF B8 01 00 00 00 85 C0 E9 B8 23 77 FF
#
#83 FE 15              cmp 15                          spell_id = 21?  
#0F 84 AF 06 00 00     jz   yyyyyyyyy                  the next spell test
#6A B4                 push B4                         
#xxxxxxxxxxxx          call 00890CB0                   call return_equipped_artifact_count
#85 C0                 test    eax, eax 
#                      jz      008B8E13                if test positive -> go to MR = 100
#83 FE 15              cmp 23                          spell_id = 35?
#0F 84 AF 06 00 00     jz   yyyyyyyyy                  zeroing registers and quiting                     
#6a 46                 push 46                      
#xxxxxxxxxxxx          call 00890CB0                   call return_equipped_artifact_count                      
#85 C0                 test    eax, eax                      
#                      jz      008B8E13                if test positive -> go to MR = 100